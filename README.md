# Ouroboros

[![Greenkeeper badge](https://badges.greenkeeper.io/yitzchak/ouroboros.svg)](https://greenkeeper.io/)

An experimental builder for LaTeX...not ready for production use.

[![Build Status][travis svg]][travis]
[![Windows Build Status][appveyor svg]][appveyor]
[![Dependency Status][dependency svg]][dependency]
[![devDependency Status][devDependency svg]][devDependency]

## Installation

Ouroboros can be used either as a library or via the [command line][].
To install Ouroboros as a library use `npm install yitzchak/ouroboros`. To
install for command line access use `npm install -g yitzchak/ouroboros-cli`.

## Library Usage

The primary class for usage is the `Ouroboros` class. The library requires a
polyfill for `Set`/`Map` usage such as `babel-polyfill`. For instance, to build
`foo.tex` and report any log messages:

```javascript
import 'babel-polyfill'
import { Ouroboros } from 'ouroboros'

const builder = await Ouroboros.create('foo.tex', { synctex: true })

builder.on('log', event => {
  const nameText = event.name ? `[${event.name}] ` : ''
  const typeText = event.category ? `${event.category}: ` : ''
  const text = `${event.severity} ${nameText}${typeText}${event.text.replace('\n', ' ')}`
  console.log(text)
})

await builder.run('load', 'build', 'log', 'save')
```

Any sequence of commands listed below may be used, but the first and last commands should
always be `load` and `save`, respectively.

| Command | Description                       |
|---------|-----------------------------------|
| build   | Build the input file              |
| clean   | Clean up after a build            |
| graph   | Graph dependencies using GraphViz |
| log     | Report log messages generated     |

### Options

The second argument to `Ouroboros.create` is an object with build options with
values listed below.

- `cleanPatterns`: Patterns to use when executing a clean command.
  - value: strings
  - default: `$outdir/$job!($outext|.synctex.gz|.tex)`,         `/$outdir/_minted-$job/*`
  - commands: clean
- `deepClean`: Remove all generated files and the cache.
  - value: boolean
  - default: `false`
  - commands: clean
- `engine`: LaTeX engine, e.g. latex, pdflatex or uplatex
  - value: string
  - default: `pdflatex`
  - aliases: `customEngine` or `program`
  - commands: Wbuild
- `ignoreCache`: ignore file cache generated by previous builds
  - value: boolean
  - default: `false`
  - commands: build
- `jobName`: job name used for latex
  - value: string
  - aliases: `jobname`
  - commands: build, clean
- `jobNames`: job names used for latex
  - value: strings
  - aliases: `jobnames`
  - commands: build, clean
- `phaseCycles`: maximum number of evaluation cycles in each phase
  - value: number
  - default: 20
  - commands: all
- `outputDirectory`: name of directory for output files
  - value: string
  - aliases: `output` or `output_directory`
  - commands: build
- `outputFormat`: output format
  - value: `dvi`, `pdf`, `ps` or `svg`
  - default: `pdf`
  - commands: build, graph
- `severity`: severity of messages to display
  - value: `info`, `warning` or `error`
  - default: `warning`
  - aliases: `loggingLevel`
  - commands: all
- `shellEscape`: enable shell escape (write18)
  - value: `disabled`, `restricted` or `enabled`
  - aliases: `enableShellEscape`
  - commands: build
- `synctex`: generate SyncTeX annotations
  - value: boolean
  - default: `false`
  - aliases: `enableSynctex`
  - commands: build

[appveyor svg]: https://ci.appveyor.com/api/projects/status/s3unjr8c90bhcd99?svg=true
[appveyor]: https://ci.appveyor.com/project/yitzchak/ouroboros/branch/master
[command line]: https://github.com/yitzchak/ouroboros-cli
[dependency svg]: https://david-dm.org/yitzchak/ouroboros.svg
[dependency]: https://david-dm.org/yitzchak/ouroboros
[devDependency svg]: https://david-dm.org/yitzchak/ouroboros/dev-status.svg
[devDependency]: https://david-dm.org/yitzchak/ouroboros?type=dev
[travis svg]: https://travis-ci.org/yitzchak/ouroboros.svg?branch=master
[travis]: https://travis-ci.org/yitzchak/ouroboros
